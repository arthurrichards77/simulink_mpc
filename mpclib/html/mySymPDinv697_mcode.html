<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="51,526" id="srcline526">526</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,527" id="srcline527">527</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S157T33U3215">Minv</span> = mySymPDinv(<span class="var type1" id="S158T33U3218">M</span>,<span class="var type1" id="S159T4U3219">flagChecking</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="51,528" id="srcline528">528</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,529" id="srcline529">529</a></span><span class="line"><span class="comment">% utility for quick inversion of a symmetric positive definite matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,530" id="srcline530">530</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,531" id="srcline531">531</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,532" id="srcline532">532</a></span><span class="line"><span class="mxinfo " id="T33:U4"><span class="var type1" id="S160T33U3222">cholM</span> = <span class="mxinfo " id="T33:U6">chol(<span class="var type1" id="S158T33U3225">M</span>,<span class="string">'lower'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,533" id="srcline533">533</a></span><span class="line"><span class="mxinfo " id="T33:U8"><span class="var type1" id="S162T33U3229">T</span> = <span class="mxinfo " id="T33:U10">linsolve(<span class="var type1" id="S160T33U3232">cholM</span>,<span class="mxinfo " id="T33:U12">eye(size(<span class="var type1" id="S158T33U3237">M</span>,1))</span>,struct(<span class="string">'LT'</span>,true))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,534" id="srcline534">534</a></span><span class="line"><span class="mxinfo " id="T33:U14"><span class="var type1" id="S157T33U3246">Minv</span> = <span class="mxinfo " id="T33:U16">linsolve(<span class="mxinfo " id="T33:U17"><span class="var type1" id="S160T33U3250">cholM</span>'</span>,<span class="var type1" id="S162T33U3251">T</span>,struct(<span class="string">'UT'</span>,true))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,535" id="srcline535">535</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,536" id="srcline536">536</a></span><span class="line"><span class="keyword">if</span> <span class="var type1" id="S159T4U3259">flagChecking</span>,</span></span>
<span class="srcline"><span class="lineno"><a href="51,537" id="srcline537">537</a></span><span class="line">    <span class="mxinfo " id="T7:U21"><span class="var type1" id="S168T7U3262">checkInv</span> = <span class="mxinfo " id="T7:U23">norm(<span class="mxinfo " id="T33:U24"><span class="mxinfo " id="T33:U25"><span class="var type1" id="S157T33U3267">Minv</span>*<span class="var type1" id="S158T33U3268">M</span></span> - <span class="mxinfo " id="T33:U28">eye(size(<span class="var type1" id="S158T33U3273">M</span>,1))</span></span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="51,538" id="srcline538">538</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,539" id="srcline539">539</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,540" id="srcline540">540</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,541" id="srcline541">541</a></span><span class="line"></span></span>
</pre>
