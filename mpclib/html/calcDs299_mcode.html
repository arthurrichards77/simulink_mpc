<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="51,541" id="srcline541">541</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,542" id="srcline542">542</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S171T1U3277">ds</span>,<span class="var type1" id="S172T1U3278">es</span>]=calcDs(<span class="var type1" id="S173T1U3281">z</span>,<span class="var type1" id="S174T16U3282">Ps</span>,<span class="var type1" id="S175T1U3283">hs</span>,<span class="var type1" id="S176T7U3284">rho</span>,<span class="var type1" id="S177T4U3285">flagNoPade</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="51,543" id="srcline543">543</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,544" id="srcline544">544</a></span><span class="line"><span class="comment">% pre-assign to help coder</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,545" id="srcline545">545</a></span><span class="line"><span class="mxinfo " id="T1:U8"><span class="var type1" id="S172T1U3288">es</span> = <span class="var type1" id="S175T1U3289">hs</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,546" id="srcline546">546</a></span><span class="line"><span class="mxinfo " id="T1:U11"><span class="var type1" id="S171T1U3292">ds</span> = <span class="var type1" id="S175T1U3293">hs</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,547" id="srcline547">547</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,548" id="srcline548">548</a></span><span class="line"><span class="comment">% residuals</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,549" id="srcline549">549</a></span><span class="line"><span class="mxinfo " id="T1:U14"><span class="var type1" id="S178T1U3296">rs</span> = <span class="mxinfo " id="T1:U16"><span class="mxinfo " id="T1:U17"><span class="var type1" id="S174T16U3299">Ps</span>*<span class="var type1" id="S173T1U3300">z</span></span> - <span class="var type1" id="S175T1U3301">hs</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,550" id="srcline550">550</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,551" id="srcline551">551</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S179T7U3304">ii</span>=<span class="mxinfo " id="T7:U22">1</span>:length(<span class="var type1" id="S175T1U3309">hs</span>),</span></span>
<span class="srcline"><span class="lineno"><a href="51,552" id="srcline552">552</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="51,553" id="srcline553">553</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T4:U24"><span class="mxinfo " id="T7:U25"><span class="var type1" id="S178T1U3314">rs</span>(<span class="var type1" id="S179T7U3315">ii</span>)</span>&gt;<span class="mxinfo " id="T7:U28">0</span></span>,</span></span>
<span class="srcline"><span class="lineno"><a href="51,554" id="srcline554">554</a></span><span class="line">        <span class="mxinfo " id="T7:U29"><span class="mxinfo " id="T7:U30"><span class="var type1" id="S172T1U3320">es</span>(<span class="var type1" id="S179T7U3321">ii</span>,<span class="mxinfo " id="T7:U33">1</span>)</span> = <span class="mxinfo " id="T7:U34"><span class="fcn" id="F298N12:B3324">myexp</span>(<span class="mxinfo " id="T7:U35"><span class="mxinfo " id="T7:U36">-<span class="var type1" id="S176T7U3327">rho</span></span>*<span class="mxinfo " id="T7:U38"><span class="var type1" id="S178T1U3329">rs</span>(<span class="var type1" id="S179T7U3330">ii</span>)</span></span>,<span class="var type1" id="S177T4U3331">flagNoPade</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,555" id="srcline555">555</a></span><span class="line">        <span class="mxinfo " id="T7:U42"><span class="mxinfo " id="T7:U43"><span class="var type1" id="S171T1U3335">ds</span>(<span class="var type1" id="S179T7U3336">ii</span>,<span class="mxinfo " id="T7:U46">1</span>)</span> = <span class="mxinfo " id="T7:U47"><span class="mxinfo " id="T7:U48">1</span>/(<span class="mxinfo " id="T7:U49"><span class="mxinfo " id="T7:U50">1</span>+<span class="mxinfo " id="T7:U51"><span class="var type1" id="S172T1U3344">es</span>(<span class="var type1" id="S179T7U3345">ii</span>,<span class="mxinfo " id="T7:U54">1</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,556" id="srcline556">556</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,557" id="srcline557">557</a></span><span class="line">        <span class="mxinfo " id="T7:U55"><span class="mxinfo " id="T7:U56"><span class="var type1" id="S172T1U3351">es</span>(<span class="var type1" id="S179T7U3352">ii</span>,<span class="mxinfo " id="T7:U59">1</span>)</span> = <span class="mxinfo " id="T7:U60"><span class="fcn" id="F298N12:B3355">myexp</span>(<span class="mxinfo " id="T7:U61"><span class="var type1" id="S176T7U3357">rho</span>*<span class="mxinfo " id="T7:U63"><span class="var type1" id="S178T1U3359">rs</span>(<span class="var type1" id="S179T7U3360">ii</span>)</span></span>,<span class="var type1" id="S177T4U3361">flagNoPade</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,558" id="srcline558">558</a></span><span class="line">        <span class="mxinfo " id="T7:U67"><span class="mxinfo " id="T7:U68"><span class="var type1" id="S171T1U3365">ds</span>(<span class="var type1" id="S179T7U3366">ii</span>,<span class="mxinfo " id="T7:U71">1</span>)</span> = <span class="mxinfo " id="T7:U72"><span class="mxinfo " id="T7:U73"><span class="var type1" id="S172T1U3370">es</span>(<span class="var type1" id="S179T7U3371">ii</span>,<span class="mxinfo " id="T7:U76">1</span>)</span>/(<span class="mxinfo " id="T7:U77"><span class="mxinfo " id="T7:U78">1</span>+<span class="mxinfo " id="T7:U79"><span class="var type1" id="S172T1U3377">es</span>(<span class="var type1" id="S179T7U3378">ii</span>,<span class="mxinfo " id="T7:U82">1</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,559" id="srcline559">559</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,560" id="srcline560">560</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,561" id="srcline561">561</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,562" id="srcline562">562</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,563" id="srcline563">563</a></span><span class="line"></span></span>
</pre>
